version: "3"

services:
  webca:
    image: tsobu/spring-cropmanager:latest
    #container_name: spring-cropmanager
    restart: always
    expose:
      - 8098

  webb:
    image: tsobu/spring-cropmanager:latest
    #container_name: spring-cropmanager
    restart: always
    expose:
      - 8098

  webc:
    image: tsobu/spring-cropmanager:latest
    #container_name: spring-cropmanager
    restart: always
    expose:
      - 8098

  haproxy:
    image: hypriot/rpi-haproxy
    volumes:
      - ./conf/haproxy.cfg:/haproxy-override
    links:
      - weba
      - webb
      - webc
    ports:
      - "80:80"
      - "70:70"
      - "8098"

    expose:
      - "80"
      - "70"
      - "8098"
networks:
  web:
    driver: overlay